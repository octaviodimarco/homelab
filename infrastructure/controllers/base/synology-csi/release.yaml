apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: synology-csi
  namespace: synology-csi
spec:
  chart:
    spec:
      chart: synology-csi
      version: 0.10.1
      sourceRef:
        kind: HelmRepository
        name: synology-csi
        namespace: flux-system
  interval: 5m
  releaseName: synology-csi
  targetNamespace: synology-csi
  install:
    timeout: 15m
    remediation:
      retries: -1
  upgrade:
    timeout: 15m
    remediation:
      retries: -1
  values:
    global:
      synology_ip: 192.168.1.79
      synology_port: 5000
      https: false
    nfs:
      enabled: true
    iscsi:
      enabled: false
    snapshotter:
      enabled: true
    defaultStorageClass:
      create: true
      isDefaultClass: true
      name: synology-csi
    controller:
      volumeMounts:
        - name: client-info
          mountPath: /etc/synology/client-info.yaml
          subPath: client-info.yml
      volumes:
        - name: client-info
          secret:
            secretName: synology-csi-client-info
    csiPlugin:
      volumeMounts:
        - name: client-info
          mountPath: /etc/synology/client-info.yaml
          subPath: client-info.yml
      volumes:
        - name: client-info
          secret:
            secretName: synology-csi-client-info
